{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function articleTemplate(article) {\n  const { webformatURL, largeImageURL, tags, likes, views, comments, downloads} = article;\n  return `<li class=\"list-el\">\n\n <a href=\"${article.largeImageURL}\"><img src='${article.webformatURL}' alt='${article.tags}'></a>\n  <div class=\"content\">\n    <div class=\"item\"><h3>Likes</h3><p>${article.likes}</p></div>\n    <div class=\"item\"><h3>Views</h3><p>${article.views}</p></div>\n    <div class=\"item\"><h3>Comments</h3><p>${article.comments}</p></div>\n    <div class=\"item\"><h3>Downloads</h3><p>${article.downloads}</p></div>\n </div>\n</li>\n`;\n}","// https://pixabay.com/api/?key=44530588-77e4763ebb7280f93ce94dd82&q=yellow+flowers&image_type=photo\n\nimport axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/';\nconst END_POINT = 'api/';\nconst KEY = '44530588-77e4763ebb7280f93ce94dd82';\n\nlet currentPage = 1;\nlet totalPages = 0;\nconst PAGE_SIZE = 15;\n\nexport async function getArticles(query,currentPage) {\n  \n  const PARAMS = new URLSearchParams({\n      key: KEY,\n      q: query,\n      image_type:  \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      page: currentPage,\n      per_page: 15,\n    });\n\n  const url = `${BASE_URL}${END_POINT}?${PARAMS}`;\n\n  const options = {\n  };\n\n  const res = await axios.get(url, options);\n  return res.data;\n}\n\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { articleTemplate } from '/js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nlet gallery = new SimpleLightbox('.gallery a');\nconst loadElem = document.querySelector('.loader');\nconst listElem = document.querySelector('.img-list');\nconst BtnLoad = document.querySelector('button[type=button]');\nimport { getArticles } from './js/pixabay-api';\n\nhideSpinner();\nhideLoad();\n\nconst refs = {\n  formElem: document.querySelector('.js-search-form'),\n  articleListElem: document.querySelector('.js-article-list'),\n  btnLoadMore: document.querySelector('.js-btn-load'),\n  loadElem: document.querySelector('.js-loader'),\n};\n\nlet query = '';\nlet currentPage = 1;\nlet totalPages = 0;\nconst PAGE_SIZE = 15;\n\n// ==========================================\nrefs.formElem.addEventListener('submit', onFormSubmit);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  query = e.target.elements.query.value.trim();\n  // showSpinner();\n  currentPage = 1;\n  refs.articleListElem.innerHTML = '';\n\n  const ok = query.trim() !== '';\n  if (!ok) {\n    hideSpinner();\n    hideLoad();\n    iziToast.error({\n      message: 'Info Search input must be filled!',\n    });\n\n    return;\n  }\n  try {\n    const data = await getArticles(query, currentPage);\n    // console.log(data);\n    hideSpinner();\n    if (data.total == 0) {\n      hideLoad();\n      iziToast.info({\n        title: 'Sorry,',\n        message:\n          'there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n    totalPages = data.total_pages;\n    renderArticles(data.hits);\n    showLoad();\n    // scrollElem();\n\n    if (data.hits.length < 15) {\n      hideLoad();\n      iziToast.info({\n        title: 'info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      // showSpinner();\n      hideSpinner();\n    }\n  } catch (err) {\n    //totalResult = 0;\n    iziToast.error({\n      title: 'Error1',\n      message: err.message,\n    });\n  }\n}\n\nfunction articlesTemplate(articles) {\n  return articles.map(articleTemplate).join('');\n}\n\nfunction renderArticles(articles) {\n  const markup = articlesTemplate(articles);\n  refs.articleListElem.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n\nfunction showSpinner() {\n  loadElem.classList.remove('visually-hidden');\n}\n\nfunction hideSpinner() {\n  loadElem.classList.add('visually-hidden');\n}\n\nfunction showLoad() {\n  BtnLoad.classList.remove('visually-hidden');\n}\n\nfunction hideLoad() {\n  BtnLoad.classList.add('visually-hidden');\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nBtnLoad.addEventListener('click', async () => {\n  showSpinner();\n  currentPage++;\n  // const data = await getArticles(query, currentPage);\n\n  try {\n    const data = await getArticles(query, currentPage);\n    // console.log(data);\n    hideSpinner();\n    if (data.total == 0) {\n      hideLoad();\n      iziToast.info({\n        title: 'Sorry,',\n        message:\n          'there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n    totalPages = data.total_pages;\n    renderArticles(data.hits);\n    showLoad();\n    scrollElem();\n\n    if (data.hits.length < 15) {\n      hideLoad();\n      iziToast.info({\n        title: 'info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      // showSpinner();\n      hideSpinner();\n    }\n  } catch (err) {\n    //totalResult = 0;\n    iziToast.error({\n      title: 'Error1',\n      message: err.message,\n    });\n  }\n\n  totalPages = data.total_pages;\n  renderArticles(data.hits);\n  hideSpinner();\n  scrollElem();\n\n  const mas = data.hits;\n  if (mas.length < 15) {\n    hideLoad();\n    iziToast.info({\n      title: 'info',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    // showSpinner();\n    hideSpinner();\n  }\n});\n\nfunction scrollElem() {\n  const liEl = listElem.children[0];\n\n  const height = liEl.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["articleTemplate","article","BASE_URL","END_POINT","KEY","getArticles","query","currentPage","PARAMS","url","options","axios","gallery","SimpleLightbox","loadElem","listElem","BtnLoad","hideSpinner","hideLoad","refs","totalPages","onFormSubmit","iziToast","data","renderArticles","showLoad","err","articlesTemplate","articles","markup","showSpinner","scrollElem","height"],"mappings":"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"}